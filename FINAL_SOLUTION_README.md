# ุงูุญู ุงููุงูู ููุดููุฉ ุฅุฏุงุฑุฉ ุงููุดุฑููู

## ุงููุดุงูู ุงูุชู ุชู ุญููุง:

### โ 1. ูุดููุฉ CORS
- ุชู ุฅุถุงูุฉ `localhost:5175` ู `localhost:5176` ุฅูู ูุงุฆูุฉ ุงูุฃุตูู ุงููุณููุญุฉ
- ุชู ุฅุตูุงุญ ุฅุนุฏุงุฏุงุช CORS ูู ุฌููุน Edge Functions

### โ 2. ูุดููุฉ ุนุฏู ุฅุถุงูุฉ ุงููุดุฑููู ูููุงุฆูุฉ
- ุชู ุฅูุดุงุก Edge Function ูุงูู `create-moderator-complete`
- ูุนูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ
- ููุดุฆ ูุดุฑููู ุญูููููู ูู ุฌุฏูู `moderators`

### โ 3. ูุดููุฉ ุงูุจุญุซ ุนู ุงููุณุชุฎุฏููู
- ุชู ุชุจุณูุท ุงูุจุญุซ ููุนูู ููุท ูุน ุฌุฏูู `profiles`
- ูุนูู ุจุดูู ูุซุงูู

### โ 4. ุฅูุดุงุก ูุดุฑููู ุญูููููู
- Edge Function ุฌุฏูุฏ ููุดุฆ ูุณุชุฎุฏููู ูู `auth`
- ููุดุฆ ูููุงุช ุดุฎุตูุฉ ูู `profiles`
- ููุดุฆ ูุดุฑููู ูู `moderators`
- ูุชุนุงูู ูุน ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู ูุงูุฌุฏุฏ
- **ุงููุณุชุฎุฏู ุงูููุฌูุฏ**: ูุบูุฑ ุฏูุฑู ุฅูู ูุดุฑู ุจุฏูู ูููุฉ ูุฑูุฑ
- **ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ**: ููุดุฆ ุญุณุงุจ ูุงูู ูุน ูููุฉ ูุฑูุฑ

## ุงูุชุบููุฑุงุช ุงููุทุจูุฉ:

### ูู `supabase/functions/create-moderator-complete/index.ts`:
- Edge Function ูุงูู ูุฅูุดุงุก ูุดุฑููู ุญูููููู
- ูุชุนุงูู ูุน ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู ูุงูุฌุฏุฏ
- ููุดุฆ ุญุณุงุจุงุช ูู `auth` ู `profiles` ู `moderators`
- ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- ุฅุนุฏุงุฏุงุช CORS ุตุญูุญุฉ
- **ุงูููุทู ุงูุฐูู**: 
  - ุงููุณุชุฎุฏู ุงูููุฌูุฏ ูู `profiles` โ ูุบูุฑ ุฏูุฑู ุฅูู ูุดุฑู (ูุง ูุญุชุงุฌ ูููุฉ ูุฑูุฑ)
  - ุงููุณุชุฎุฏู ุงูููุฌูุฏ ูู `auth.users` ููุท โ ููุดุฆ ููู ุดุฎุตู ููุฌุนูู ูุดุฑู (ูุง ูุญุชุงุฌ ูููุฉ ูุฑูุฑ)
  - ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ โ ููุดุฆ ุญุณุงุจ ูุงูู (ูุญุชุงุฌ ูููุฉ ูุฑูุฑ)

### ูู `supabase/functions/search-user-complete/index.ts`:
- Edge Function ููุจุญุซ ุงูุดุงูู ุนู ุงููุณุชุฎุฏููู
- ูุจุญุซ ูู `profiles` ุฃููุงู
- ุฅุฐุง ูู ูุฌุฏุ ูุจุญุซ ูู `auth.users`
- ููุดุฆ ููู ุดุฎุตู ุชููุงุฆูุงู ูููุณุชุฎุฏููู ุงูููุฌูุฏูู ูู `auth` ููุท
- ูุญู ูุดููุฉ ุฎุทุฃ 406 ูููุณุชุฎุฏููู ุงูููุฌูุฏูู ูู `auth` ูููุณ ูู `profiles`

### ูู `src/components/ModeratorManagement.tsx`:

1. **ุงูุจุญุซ ุนู ุงููุณุชุฎุฏููู:**
   ```typescript
   // ุงุณุชุฏุนุงุก Edge Function ููุจุญุซ ุงูุดุงูู
   const response = await fetch(`${supabase.supabaseUrl}/functions/v1/search-user-complete`, {
     method: 'POST',
     headers: {
       'Content-Type': 'application/json',
       'Authorization': `Bearer ${supabase.supabaseKey}`,
     },
     body: JSON.stringify({ email })
   });
   ```

2. **ุฅูุดุงุก ุงููุดุฑููู:**
   ```typescript
   // ุงุณุชุฏุนุงุก Edge Function ุงููุงูู
   const response = await fetch(`${supabase.supabaseUrl}/functions/v1/create-moderator-complete`, {
     method: 'POST',
     headers: {
       'Content-Type': 'application/json',
       'Authorization': `Bearer ${supabase.supabaseKey}`,
     },
     body: JSON.stringify({
       email: formData.email,
       full_name: formData.full_name,
       password: formData.password,
       createFullAccount: formData.createFullAccount
     })
   });
   ```

## ููููุฉ ุงูุงุฎุชุจุงุฑ:

### 1. ุงุฎุชุจุงุฑ ุงูุจุญุซ:
1. ุงุฐูุจ ุฅูู ููุญุฉ ุงูุชุญูู
2. ุงุฎุชุฑ ูุณู "ุฅุฏุงุฑุฉ ุงููุดุฑููู"
3. ุงูุชุจ ุฅูููู ูุณุชุฎุฏู ููุฌูุฏ ูู ุฌุฏูู `profiles`
4. ูุฌุจ ุฃู ูุธูุฑ ุงูุงุณู ุชููุงุฆูุงู

### 2. ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงููุดุฑู:
1. ุงุถุบุท ุนูู "ุฅุถุงูุฉ ูุดุฑู ุฌุฏูุฏ"
2. ุงููุฃ ุงูุจูุงูุงุช ุงููุทููุจุฉ:
   - **ูููุณุชุฎุฏู ุงูููุฌูุฏ**: ุงูุชุจ ุงูุฅูููู ูุงูุงุณู ููุท (ูุง ุชุญุชุงุฌ ูููุฉ ูุฑูุฑ)
   - **ูููุณุชุฎุฏู ุงูุฌุฏูุฏ**: ุงูุชุจ ุงูุฅูููู ูุงูุงุณู ููููุฉ ุงููุฑูุฑ
3. ุงุถุบุท "ุฅูุดุงุก ุงููุดุฑู"
4. ุณูุชู ุฅูุดุงุก ูุดุฑู ุญูููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. ุณูุธูุฑ ูู ูุงุฆูุฉ ุงููุดุฑููู ุชููุงุฆูุงู

## ุงููุธุงุฆู ุงููุชุงุญุฉ:

### โ ุชุนูู ุจุดูู ุตุญูุญ:
- โ ุงูุจุญุซ ุนู ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู
- โ ุฅูุดุงุก ูุดุฑููู ุฌุฏุฏ (ุญูููููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- โ ุนุฑุถ ูุงุฆูุฉ ุงููุดุฑููู
- โ ุญุฐู ุงููุดุฑููู
- โ ุชุญุฏูุซ ูุงุฆูุฉ ุงููุดุฑููู ุชููุงุฆูุงู
- โ ุฅูุดุงุก ุญุณุงุจุงุช ูุงููุฉ ูู `auth` ู `profiles` ู `moderators`

### ๐ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:
- โ ุฅูุดุงุก ูุดุฑููู ุญูููููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุงูุชุนุงูู ูุน ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู ูุงูุฌุฏุฏ
- โ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- โ ุฑุณุงุฆู ูุฌุงุญ ูุฎุทุฃ ูุงุถุญุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ูููุงุฆูุฉ

## ููุงุญุธุงุช ูููุฉ:

1. **ุงูุฃูุงู:** ูุณุชุฎุฏู `SUPABASE_SERVICE_ROLE_KEY` ููุนูููุงุช ุงููููุฒุฉ
2. **ุงูุฃุฏุงุก:** ุณุฑูุน ูููุซูู
3. **ุงูุชุตููู:** ูุญููุธ ููุง ูู - ููุณ ุงูุฃููููุงุช ูุงูุฃููุงู
4. **ุงูุชูุงูู:** ูุนูู ูุน ุฌููุน ุงููุชุตูุญุงุช
5. **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** ููุดุฆ ุจูุงูุงุช ุญููููุฉ ูู ุฌููุน ุงูุฌุฏุงูู

## ููุงุฎุชุจุงุฑ ุงูุขู:
1. ุงูุชุญ ุงููููุน ุนูู `http://localhost:5177` (ุฃู ุงููููุฐ ุงูุฐู ูุธูุฑ ูู Terminal)
2. ุงุฐูุจ ุฅูู ููุญุฉ ุงูุชุญูู
3. ุงุฎุชุฑ ูุณู "ุฅุฏุงุฑุฉ ุงููุดุฑููู"
4. ุฌุฑุจ ุฅุถุงูุฉ ูุดุฑู ุฌุฏูุฏ - ุณูุชู ุฅูุดุงุคู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. ุฌุฑุจ ุงูุจุญุซ ุนู ูุณุชุฎุฏู ููุฌูุฏ - ูุนูู ุจุดูู ูุซุงูู

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:
- โ ุฅุตูุงุญ ูุดููุฉ ุนููุฏ `status` ุบูุฑ ุงูููุฌูุฏ
- โ ุงุณุชุฎุฏุงู `is_active: true` ุจุฏูุงู ูู `status: 'active'`
- โ ุฅุถุงูุฉ `created_by` ูููุดุฑู ุงูุฌุฏูุฏ
- โ Edge Function ูุญุฏุซ ููููุดุฑ ุจูุฌุงุญ
- โ ุฅุตูุงุญ ูุดููุฉ ุงูุจุญุซ ุนู ุงููุณุชุฎุฏููู ูู `auth.users`
- โ ุฅูุดุงุก Edge Function `search-user-complete` ููุจุญุซ ุงูุดุงูู
- โ ุงูุจุญุซ ูู `profiles` ู `auth.users` ูุฅูุดุงุก ููู ุดุฎุตู ุชููุงุฆูุงู
- โ ุฅุตูุงุญ ูุดููุฉ ูููุฉ ุงููุฑูุฑ ูููุณุชุฎุฏููู ุงูููุฌูุฏูู
- โ ุงูููุทู ุงูุฐูู: ุงููุณุชุฎุฏู ุงูููุฌูุฏ ูุง ูุญุชุงุฌ ูููุฉ ูุฑูุฑ
- โ ุชุญุฏูุซ ุฏูุฑ ุงููุณุชุฎุฏู ุงูููุฌูุฏ ุฅูู ูุดุฑู ุชููุงุฆูุงู
- โ ุฅุตูุงุญ ูุดููุฉ ุฅูุดุงุก ุงูููู ุงูุดุฎุตู ูููุณุชุฎุฏููู ุงูููุฌูุฏูู ูู `auth.users`
- โ ุงูุจุญุซ ุงูุดุงูู ูู `profiles` ู `auth.users` ูุฅูุดุงุก ููู ุดุฎุตู ุชููุงุฆูุงู

**ุงูุญู ูุนูู ุงูุขู ุจุดูู ูุงูู! ุงููุดุฑููู ุงูุฌุฏุฏ ูุชู ุฅูุดุงุคูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ.** ๐โจ

## ุงูุฎุทูุงุช ุงูููุชููุฉ:
- โ ุฅูุดุงุก Edge Function ูุงูู ูุฅูุดุงุก ูุดุฑููู ุญูููููู
- โ ุฑุจุท ุงููุดุฑููู ุงูุฌุฏุฏ ูุน ูุธุงู ุงููุตุงุฏูุฉ
- โ ุฅูุดุงุก ูููุงุช ุดุฎุตูุฉ ุชููุงุฆูุงู
- โ ุญู ูุดููุฉ RLS policies ุจุงุณุชุฎุฏุงู Service Role Key
- โ ุฅุนุฏุงุฏุงุช CORS ุตุญูุญุฉ

## ุงูุญุงูุฉ ุงูุญุงููุฉ:
- โ ุงูุจุญุซ ูุนูู ุจุดูู ูุซุงูู
- โ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุชุนูู ุจุดูู ูุซุงูู
- โ ุฅูุดุงุก ุงููุดุฑููู ูุนูู ุจุดูู ูุงูู
- โ ุงููุดุฑููู ุงูุฌุฏุฏ ูุธูุฑูู ูู ุงููุงุฆูุฉ ุชููุงุฆูุงู
- โ ุฌููุน ุงููุธุงุฆู ุชุนูู ุจุดูู ูุซุงูู

**๐ ุงูุญู ุงููุงูู ุฌุงูุฒ ููุนูู ุจุดูู ูุซุงูู!**
